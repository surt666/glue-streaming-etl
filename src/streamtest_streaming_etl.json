{
	"jobConfig": {
		"name": "streamjob",
		"description": "",
		"role": "arn:aws:iam::018744099911:role/lundbeck-ingestion-role",
		"command": "gluestreaming",
		"version": "4.0",
		"runtime": null,
		"workerType": "G.025X",
		"numberOfWorkers": 8,
		"maxCapacity": 2,
		"maxRetries": 0,
		"maxConcurrentRuns": 1,
		"security": "none",
		"scriptName": "job.py",
		"scriptLocation": "s3://aws-glue-assets-018744099911-eu-west-1/scripts/",
		"language": "python-3",
		"spark": false,
		"sparkConfiguration": "standard",
		"jobParameters": [],
		"tags": [],
		"jobMode": "VISUAL_MODE",
		"createdOn": "2023-11-17T12:03:44.870Z",
		"developerMode": false,
		"connectionsList": [],
		"temporaryDirectory": "s3://aws-glue-assets-018744099911-eu-west-1/temporary/",
		"etlAutoScaling": true,
		"logging": true,
		"etlAutoTuning": true,
		"metrics": true,
		"bookmark": "job-bookmark-disable",
		"sparkPath": "s3://aws-glue-assets-018744099911-eu-west-1/sparkHistoryLogs/",
		"flexExecution": false,
		"minFlexWorkers": null,
		"pythonPath": ""
	},
	"dag": {
		"node-1701074388122": {
			"nodeId": "node-1701074388122",
			"dataPreview": false,
			"previewAmount": 0,
			"inputs": [
				"node-1700222341275"
			],
			"name": "Custom Transform",
			"generatedNodeName": "CustomTransform_node1701074388122",
			"classification": "Transform",
			"type": "CustomCode",
			"code": "dynamic_frames = {}\n\ndef process_row(record):\n    blocks = record[\"HISTORY\"][\"BLOCKS\"]\n    results = []  # Initialize an empty list to collect results\n\n    for b in blocks:\n        for tag in b[\"TAGS\"]:\n            for data_entry in tag[\"DATA\"]:\n                result = {\n                    \"start\": record[\"HISTORY\"][\"ENV\"][\"TIME\"][\"START\"][\"POSIX\"],\n                    \"end\": record[\"HISTORY\"][\"ENV\"][\"TIME\"][\"END\"][\"POSIX\"],\n                    \"id\": tag[\"DEFINITION\"][\"ID\"],\n                    \"source_object\": tag[\"DEFINITION\"][\"SOURCEOBJECT\"],\n                    \"t\": data_entry[\"T\"],\n                    \"q\": data_entry[\"Q\"],\n                    \"v\": data_entry[\"V\"]\n                }\n                results.append(result)\n\n    return results  # Return the list of results\nfor key in dfc.keys():\n    df = dfc[key]\n    rdd = df.toDF().rdd.flatMap(process_row)\n    new_df = rdd.toDF()\n    new_dynamic_frame = DynamicFrame.fromDF(new_df, glueContext, \"new_dynamic_frame\")\n    dynamic_frames[key] = new_dynamic_frame\n\nreturn DynamicFrameCollection(dynamic_frames, glueContext)\n",
			"className": "IoTFlattenTransform",
			"outputSchemas": null,
			"parentsValid": true,
			"calculatedType": "",
			"codeGenVersion": 2
		},
		"node-1701074537972": {
			"nodeId": "node-1701074537972",
			"dataPreview": false,
			"previewAmount": 0,
			"inputs": [
				"node-1701074388122"
			],
			"name": "Select From Collection",
			"generatedNodeName": "SelectFromCollection_node1701074537972",
			"classification": "Transform",
			"type": "SelectFromCollection",
			"index": 0,
			"parentsValid": true,
			"calculatedType": "",
			"codeGenVersion": 2
		},
		"node-1701070996315": {
			"nodeId": "node-1701070996315",
			"dataPreview": false,
			"previewAmount": 0,
			"inputs": [
				"node-1701074537972"
			],
			"name": "Amazon S3",
			"generatedNodeName": "AmazonS3_node1701070996315",
			"classification": "DataSink",
			"type": "S3",
			"streamingBatchInterval": 100,
			"format": "glueparquet",
			"compression": "snappy",
			"path": "s3://lundbeck-018744099911-eu-west-1-raw/devices_raw_stream/",
			"partitionKeys": [],
			"schemaChangePolicy": {
				"enableUpdateCatalog": false,
				"updateBehavior": null,
				"database": null,
				"table": null
			},
			"updateCatalogOptions": "none",
			"calculatedType": "",
			"codeGenVersion": 2
		},
		"node-1700222341275": {
			"nodeId": "node-1700222341275",
			"dataPreview": false,
			"previewAmount": 0,
			"inputs": [],
			"name": "Amazon Kinesis",
			"generatedNodeName": "AmazonKinesis_node1700222341275",
			"classification": "DataSource",
			"type": "Kinesis",
			"isCatalog": false,
			"windowSize": 100,
			"detectSchema": true,
			"streamingOptions": {
				"endpointUrl": null,
				"streamName": null,
				"classification": "json",
				"delimiter": null,
				"startingPosition": "earliest",
				"startingTimestamp": null,
				"maxFetchTimeInMs": null,
				"maxFetchRecordsPerShard": null,
				"maxRecordPerRead": null,
				"addIdleTimeBetweenReads": null,
				"idleTimeBetweenReadsInMs": null,
				"describeShardInterval": null,
				"numRetries": null,
				"retryIntervalMs": null,
				"maxRetryIntervalMs": null,
				"avoidEmptyBatches": null,
				"streamARN": "arn:aws:kinesis:eu-west-1:018744099911:stream/lundbeck-Kinesis-Stream",
				"awsSTSRoleARN": "",
				"awsSTSSessionName": null,
				"addRecordTimestamp": null,
				"emitConsumerLagMetrics": null
			},
			"isKinesisSameAccount": true,
			"nameToUse": "dataframe_AmazonKinesis_node1700222341275",
			"calculatedType": "",
			"codeGenVersion": 2
		}
	},
	"hasBeenSaved": false
}